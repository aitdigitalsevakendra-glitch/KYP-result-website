<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>KYP Admin Panel</title>

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Arial;}

body{
  display:flex;
  background:#f4f6f9;
}

/* SIDEBAR */
.sidebar{
  width:240px;
  height:100vh;
  background:#1f2d3d;
  color:#fff;
  position:fixed;
  left:0;
  top:0;
}

.logo{
  padding:18px;
  font-size:20px;
  font-weight:bold;
  background:#17212b;
  text-align:center;
}

.menu{
  padding:14px 20px;
  cursor:pointer;
  border-bottom:1px solid rgba(255,255,255,0.05);
}

.menu:hover{
  background:#2c3e50;
}

/* MAIN AREA */
.main{
  margin-left:240px;
  padding:25px;
  width:100%;
}

.topbar{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:25px;
}

.card-grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
  gap:20px;
}

.card{
  background:#fff;
  padding:20px;
  border-radius:10px;
  box-shadow:0 2px 8px rgba(0,0,0,0.08);
}

.page{display:none;}
#dashboardPage{display:block;}

button{
  padding:10px 18px;
  border:none;
  background:#007bff;
  color:white;
  border-radius:6px;
  cursor:pointer;
}
button:hover{background:#0056b3;}
</style>
</head>

<body>

<!-- ğŸ”µ SIDEBAR -->
<div class="sidebar">
  <div class="logo">ğŸ”¥ ADMIN PANEL</div>

  <div class="menu" onclick="openPage('dashboard')">ğŸ  Dashboard</div>
  <div class="menu" onclick="openPage('students')">ğŸ“ Students</div>
  <div class="menu" onclick="openPage('results')">ğŸ§¾ Results</div>
  <div class="menu" onclick="openPage('assistants')">ğŸ‘¨â€ğŸ’¼ Assistants</div>
  <div class="menu" onclick="openPage('payments')">ğŸ’° Payments</div>
  <div class="menu" onclick="openPage('settings')">âš™ï¸ Settings</div>
  <div class="menu" onclick="logout()">ğŸšª Logout</div>
</div>

<!-- ğŸ”µ MAIN -->
<div class="main">

  <div class="topbar">
    <h2 id="pageTitle">Dashboard</h2>
    <div>ğŸ‘¤ <span id="adminName">Admin</span></div>
  </div>

  <!-- âœ… DASHBOARD -->
  <div id="dashboardPage" class="page">
    <div class="card-grid">
      <div class="card"><h3>Total Students</h3><h2 id="totalStudents">0</h2></div>
      <div class="card"><h3>Registered</h3><h2 id="registeredStudents">0</h2></div>
      <div class="card"><h3>Approved</h3><h2 id="approvedStudents">0</h2></div>
      <div class="card"><h3>Total Payment</h3><h2 id="totalPayment">0</h2></div>
    </div>
  </div>

  <!-- âœ… STUDENTS -->
  <div id="studentsPage" class="page">
    <h2>ğŸ“ Students Management</h2><br>
    <button onclick="alert('Add Student form yahan ayega')">+ Add Student</button>
  </div>

  <!-- âœ… RESULTS -->
  <div id="resultsPage" class="page">
    <h2>ğŸ§¾ Results Management</h2>
  </div>

  <!-- âœ… ASSISTANTS -->
  <div id="assistantsPage" class="page">
    <h2>ğŸ‘¨â€ğŸ’¼ Assistants Management</h2>
  </div>

  <!-- âœ… PAYMENTS -->
  <div id="paymentsPage" class="page">
    <h2>ğŸ’° Payments</h2>
  </div>

  <!-- âœ… SETTINGS -->
  <div id="settingsPage" class="page">
    <h2>âš™ï¸ Settings</h2>
  </div>

</div>

<!-- ğŸ”¥ FIREBASE + LOGIC -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import {
  getFirestore,
  collection,
  getDocs
} from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";
import {
  getAuth,
  onAuthStateChanged,
  signOut
} from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";

const firebaseConfig = {
  apiKey: "AIzaSyBtRcPSgV49ybyLcH1P9Ar5GJoUEOdhNvQ",
  authDomain: "kyp-result-portal.firebaseapp.com",
  projectId: "kyp-result-portal",
  storageBucket: "kyp-result-portal.firebasestorage.app",
  messagingSenderId: "454908710797",
  appId: "1:454908710797:web:4ddac5514e53f15819f7c4"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const auth = getAuth(app);

/* ğŸ” CHECK LOGIN */
onAuthStateChanged(auth,(user)=>{
  if(!user){
    window.location.href="admin-login.html";
  }else{
    document.getElementById("adminName").innerText=user.email;
    loadDashboard();
  }
});

/* ğŸ“Š LOAD DASHBOARD */
async function loadDashboard(){
  const snap = await getDocs(collection(db,"students"));
  document.getElementById("totalStudents").innerText = snap.size;
  document.getElementById("approvedStudents").innerText = snap.size;
}

/* ğŸšª LOGOUT */
window.logout = async function(){
  await signOut(auth);
  window.location.href="admin-login.html";
}

/* ğŸ“‚ PAGE SWITCH */
window.openPage = function(page){

  document.querySelectorAll(".page").forEach(p=>p.style.display="none");

  document.getElementById(page+"Page").style.display="block";
  document.getElementById("pageTitle").innerText =
    page.charAt(0).toUpperCase()+page.slice(1);
}
</script>

</body>
</html>
